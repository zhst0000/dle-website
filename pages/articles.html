<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="../src/css/main.css">

  <link rel="stylesheet" href="../src/css/articlecard.css">
  <title>Articles</title>
  <link rel="icon" type="x-icon" href="../assets/logo.svg">

  <style>
    html, body {
      height: 100%;
      font-family: var(--article-font-body);
      background: var(--color-theme-cool-200);
      margin: 0;
    }

    body {
      display: flex;
      flex-direction: column;
    }

    main {
      flex: 1;
    }

    #search-bar {
      display: block;
      margin: 1rem auto;
      width: 60%;
      padding: 10px;
      font-size: 1rem;
      border: 1px solid #999;
      border-radius: 5px;
    }

    .filters {
      display: flex;
      flex-wrap: wrap;
      gap: 2rem;
      justify-content: center;
      margin-bottom: 2rem;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .filter-group label {
      margin-bottom: 0.5rem;
      font-weight: bold;
    }

    .pills {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .pill {
      background: #ddd;
      color: #333;
      border: none;
      padding: 6px 12px;
      border-radius: 999px;
      cursor: pointer;
    }

    .pill.active {
      background: #333;
      color: #fff;
    }

    .date-filter {
      display: flex;
      flex-direction: row; /* horizontal layout */
      align-items: center;
      gap: 0.5rem;
    }

    .date-filter label {
      margin-bottom: 0; /
    }
    .date-filter select,
    .date-filter input {
      margin: 0; /* reset margin */
      padding: 6px;
    }
    .no-results {
      text-align: center;
      font-style: italic;
      margin-top: 2rem;
    }
  </style>
</head>

<body style="background-color: var(--color-theme-cool-200);">
  <header>
    <div class="header-container">
      <div class="header-left">
      <img src="../assets/logo.svg" alt="Logo" class="header-logo">
      <a href="../index.html" class="header-title">Puzzle Bus</a>
      </div>
      <nav class="header-nav">
        <ul>
        <li class="flairitem1"><a href="../index.html" class="nav-btn btn-1">Articles</a></li>
        <li class="flairitem2"><a href="../pages/shortlist.html" class="nav-btn btn-2">Shortlist</a></li>
        <li class="flairitem3"><a href="../pages/about_us.html" class="nav-btn btn-3">About</a></li>
        <li class="flairitem4"><a href="../pages/contact_us.html" class="nav-btn btn-4">Contact</a></li>
        <div class="flairEnd" id="flair1"><div class="flairEndLittle"></div></div>
        <div class="flairEnd" id="flair2"><div class="flairEndLittle"></div>
        </ul>
      </nav>
    </div>
  </header>

  <input type="text" id="search-bar" placeholder="Search articles...">

  <div class="filters">
    <div class="filter-group">
      <label>Type</label>
      <div class="pills" id="type-pills"></div>
    </div>
    <div class="filter-group">
      <label>Genre</label>
      <div class="pills" id="genre-pills"></div>
    </div>
    <div class="filter-group date-filter">
      <label>Date Filter</label>
      <select id="date-mode">
        <option value="none">None</option>
        <option value="before">Before</option>
        <option value="after">After</option>
        <option value="between">Between</option>
      </select>
      <input type="date" id="date-start">
      <input type="date" id="date-end" style="display:none;">
    </div>
  </div>

  <main>
    <div class="article-grid" id="cards-container">

      <article class="article-card" data-tags="type-meta" data-date="2025-07-21">
        <a href="../pages/meta_welcome/meta_welcome.html">
          <img src="../pages/meta_welcome/welcome_banner.svg" alt="Launch and Welcome">
        </a>
        <div class="article-content">
          <div class="category">
            <span class="category-pill">Meta</span>
          </div>
          <h3>Welcome!</h3>
          <div class="meta">2025-07-21</div>
          <p>Enjoy your ride</p>
        </div>
      </article>
      
      <article class="article-card" data-tags="type-review genre-movies" data-date="2025-07-21">
        <a href="../pages/review_burgle/review_burgle.html">
          <img src="../pages/review_burgle/burgle_banner.png" alt="Burgle Review">
        </a>
        <div class="article-content">
          <div class="category">
            <span class="category-pill">Review</span>
          </div>
          <h3>Burgle Review</h3>
          <div class="meta">2025-07-21</div>
          <p>A keyword-based movie guessing game</p>
        </div>
      </article>

      <article class="article-card" data-tags="type-review genre-geography" data-date="2025-07-21">
        <a href="../pages/review_foodguessr/review_foodguessr.html">
          <img src="../pages/review_foodguessr/foodguessr_banner.png" alt="Foodguessr Review">
        </a>
        <div class="article-content">
          <div class="category">
            <span class="category-pill">Review</span>
          </div>
          <h3>Foodguessr Review</h3>
          <div class="meta">2025-07-21</div>
          <p>Where's that dish from?</p>
        </div>
      </article>

      <article class="article-card" data-tags="type-review genre-geography" data-date="2025-07-21">
        <a href="../pages/review_travle/review_travle.html">
          <img src="../pages/review_travle/travle_banner.png" alt="Travle Review">
        </a>
        <div class="article-content">
          <div class="category">
            <span class="category-pill">Review</span>
          </div>
          <h3>Travle Review</h3>
          <div class="meta">2025-07-21</div>
          <p>Find a path between 2 given countries</p>
        </div>
      </article>

      <article class="article-card" data-tags="type-review genre-misc" data-date="2025-07-21">
        <a href="../pages/under_construction.html">
          <img src="../pages/review_ontherecord/ontherecord_banner.png" alt="On the Record Review">
        </a>
        <div class="article-content">
          <div class="category">
            <span class="category-pill">Review</span>
          </div>
          <h3>On the Record Review</h3>
          <div class="meta">2025-07-21</div>
          <p>A quiz of current events</p>
        </div>
      </article>

      <article class="article-card" data-tags="type-review genre-trivia" data-date="2025-07-21">
        <a href="../pages/under_construction.html">
          <img src="../pages/review_catfishing/catfishing_banner.png" alt="Catfishing Review">
        </a>
        <div class="article-content">
          <div class="category">
            <span class="category-pill">Review</span>
          </div>
          <h3>Catfishing Review</h3>
          <div class="meta">2025-07-21</div>
          <p>Guess Wikipedia articles from their category tags</p>
        </div>
      </article>

      <article class="article-card" data-tags="type-review genre-misc" data-date="2025-07-21">
        <a href="../pages/under_construction.html">
          <img src="../pages/review_orderup/orderup_banner.png" alt="Order Up Review">
        </a>
        <div class="article-content">
          <div class="category">
            <span class="category-pill">Review</span>
          </div>
          <h3>Order Up Review</h3>
          <div class="meta">2025-07-21</div>
          <p><b>NOTE: Currently unavailable</b></p>
          <p>Sort items by a secret metric</p>
        </div>
      </article>

    </div>

    <div class="no-results" id="no-results" style="display:none;">No articles found.</div>
  </main>

  <footer>
    <div class="footer-container">
      <div class="footer-head">
        <div class="footer-head-title">
          <div class="footer-logo">
            <img src="../assets/logo.svg" alt="Puzzle Bus Logo" />
          </div>
          <h4>Puzzle Bus</h4>
        </div>
        <p>A hub for discussion of daily puzzle games.</p>

        <div class="footer-icon">
          <a href="#" target="_blank" rel="noopener">
            <img src="../pages/ContactUsPageAssets/youtubeIcon.png" alt="YouTube" />
          </a>
          <a href="https://www.reddit.com/r/PuzzleBus/" target="_blank" rel="noopener">
            <img src="../pages/ContactUsPageAssets/redditIcon.png" alt="Reddit" />
          </a>
          <a href="https://www.instagram.com/puzzle_bus/" target="_blank" rel="noopener">
            <img src="../pages/ContactUsPageAssets/instagramIcon.png" alt="Instagram" />
          </a>
        </div>

      </div>

      <div class="footer-column">
        <h4>Nav</h4>
        <ul>
          <li><a href="../index.html">Home</a></li>
          <li><a href="../pages/articles.html">Articles</a></li>
          <li><a href="../pages/shortlist.html">Shortlist</a></li>
        </ul>
      </div>
      <div class="footer-column">
        <h4>Other</h4>
        <ul>
          <li><a href="../pages/about_us.html">About</a></li>
          <li><a href="../pages/contact_us.html">Contact</a></li>
        </ul>
      </div>
    </div>

    <div class="footer-bottom">&copy; 2025 Puzzle Bus.</div>
  </footer>

  <script>
    const searchBar = document.getElementById('search-bar');
    const cards = document.querySelectorAll('.article-card');
    const noResults = document.getElementById('no-results');
    const typePillsContainer = document.getElementById('type-pills');
    const genrePillsContainer = document.getElementById('genre-pills');
    const dateMode = document.getElementById('date-mode');
    const dateStart = document.getElementById('date-start');
    const dateEnd = document.getElementById('date-end');

    let selectedTypes = new Set();
    let selectedGenres = new Set();

    const typeTags = new Set();
    const genreTags = new Set();

    cards.forEach(card => {
      const tags = card.dataset.tags.split(' ');
      tags.forEach(tag => {
        if (tag.startsWith('type-')) typeTags.add(tag);
        if (tag.startsWith('genre-')) genreTags.add(tag);
      });
    });

    function createPill(tag, container, selectedSet) {
      const button = document.createElement('button');
      const label = tag.replace(/^type-|^genre-/, '');
      button.className = 'pill';
      button.textContent = label.charAt(0).toUpperCase() + label.slice(1);

      button.addEventListener('click', () => {
        if (selectedSet.has(tag)) {
          selectedSet.delete(tag);
          button.classList.remove('active');
        } else {
          selectedSet.add(tag);
          button.classList.add('active');
        }
        filterCards();
      });

      container.appendChild(button);
    }

    typeTags.forEach(tag => createPill(tag, typePillsContainer, selectedTypes));
    genreTags.forEach(tag => createPill(tag, genrePillsContainer, selectedGenres));

    dateMode.addEventListener('change', () => {
      if (dateMode.value === 'between') {
        dateEnd.style.display = 'inline-block';
      } else {
        dateEnd.style.display = 'none';
      }
      filterCards();
    });

    dateStart.addEventListener('change', filterCards);
    dateEnd.addEventListener('change', filterCards);

    function filterCards() {
      const query = searchBar.value.trim().toLowerCase();
      const mode = dateMode.value;
      const startDate = dateStart.value ? new Date(dateStart.value) : null;
      const endDate = dateEnd.value ? new Date(dateEnd.value) : null;

      let visibleCount = 0;

      cards.forEach(card => {
        const title = card.querySelector('h3').textContent.toLowerCase();
        const content = card.querySelector('p').textContent.toLowerCase();
        const tags = card.dataset.tags.split(' ');
        const cardDate = new Date(card.dataset.date);

        const matchesQuery = !query || title.includes(query) || content.includes(query);
        const matchesType = selectedTypes.size === 0 || Array.from(selectedTypes).some(tag => tags.includes(tag));
        const matchesGenre = selectedGenres.size === 0 || Array.from(selectedGenres).some(tag => tags.includes(tag));

        let matchesDate = true;
        if (mode === 'before' && startDate) matchesDate = cardDate < startDate;
        if (mode === 'after' && startDate) matchesDate = cardDate > startDate;
        if (mode === 'between' && startDate && endDate) matchesDate = cardDate >= startDate && cardDate <= endDate;

        if (matchesQuery && matchesType && matchesGenre && matchesDate) {
          card.style.display = 'flex';
          visibleCount++;
        } else {
          card.style.display = 'none';
        }
      });

      noResults.style.display = visibleCount === 0 ? 'block' : 'none';
    }

    searchBar.addEventListener('input', () => {
      filterCards();
    });
  </script>
</body>
</html>
